#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "Running pre-commit checks..."

# Run forge fmt
echo "ğŸ”§ Running forge fmt..."
forge fmt

# Check if there are any changes after formatting
if ! git diff --exit-code --quiet; then
  echo "âŒ Code formatting changes detected. Please stage the formatted files."
  echo "Run: git add -A"
  exit 1
fi

# Run forge build
echo "ğŸ”¨ Building contracts..."
forge build --sizes || exit 1

# Run tests
echo "ğŸ§ª Running tests..."
forge test || exit 1

echo "âœ… All pre-commit checks passed!"